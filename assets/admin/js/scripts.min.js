"use strict";function ownKeys(t,e){var n,i=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)),i}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(s){var l=s.i18n.__,e=s.blocks.registerBlockType,o=s.serverSideRender,a=s.blockEditor.useBlockProps,t=s.element,i=t.Fragment,c=t.createElement,n=t.useEffect,r=s.components,u=r.SelectControl,d=r.TextControl,p=r.PanelRow,b=r.PanelBody,t=s.data.withSelect,r=s.compose.compose,h=s.editor.InspectorControls;r(t(function(e,t){return{posts:e("core").getEntityRecords("postType","linked_events_config",{orderby:"title",order:"asc",per_page:100,status:"publish"})}}))(function(t){var n=[];return t.posts?(n.push({value:0,label:l("Select configuration","helsinki-linkedevents")}),t.posts.forEach(function(e){n.push({value:e.id,label:e.title.rendered})})):n.push({value:0,label:l("Loading","helsinki-linkedevents")}),c(u,{label:l("Events configuration","helsinki-linkedevents"),value:t.attributes.configID,onChange:function(e){t.setAttributes({configID:e})},options:n})});function f(e){return c(h,{},c(b,{title:l("Settings","helsinki-linkedevents"),initialOpen:!0},(n=e,c(i,{},c(d,{label:l("Event Listing URL","helsinki-linkedevents"),type:"text",value:n.attributes.configURL,onChange:function(e){n.setAttributes({configURL:e})}}),c(p,{},c("small",{style:{color:"grey",marginBottom:"1rem",marginTop:"-1rem"}},l("Tapahtumat.hel.fi web address, on the basis of which the listing is formed. For example,  ","helsinki-linkedevents"),c("a",{href:"https://tapahtumat.hel.fi/fi/haku?categories=music"},"https://tapahtumat.hel.fi/fi/haku?categories=music"),".")))),(t=e,c(p,{},c(u,{label:l("Number of events","helsinki-linkedevents"),value:t.attributes.eventsCount,onChange:function(e){t.setAttributes({eventsCount:e})},options:[{label:3,value:3},{label:5,value:5},{label:10,value:10}]})))));var t,n}function v(e){return e.isSelected?c("div",a(),c("div",{className:"helsinki-events events"},c("div",{className:"hds-container"},(i=e,r={placeholder:l("This is the title","hds-wp"),titleAttribute:"title",className:"events__title"},s.element.createElement(s.blockEditor.RichText,{tagName:"h2",className:r.className||"content__heading",value:r.titleAttribute?i.attributes[r.titleAttribute]:i.attributes.contentTitle,onChange:function(e){i.setAttributes(r.titleAttribute?_defineProperty({},r.titleAttribute,e):{contentTitle:e})},allowedFormats:[],placeholder:r.placeholder||s.i18n.__("Title","helsinki-linkedevents")})),(t=e,n={placeholder:l("This is the excerpt.","hds-wp"),className:"events__excerpt"},s.element.createElement(s.blockEditor.RichText,{tagName:"p",className:n.className||"content__text",value:n.textAttribute?t.attributes[n.textAttribute]:t.attributes.contentText,onChange:function(e){t.setAttributes(n.textAttribute?_defineProperty({},n.textAttribute,e):{contentText:e})},placeholder:n.placeholder||s.i18n.__("Excerpt","helsinki-linkedevents")})),c(o,{block:"helsinki-linkedevents/grid",attributes:_objectSpread(_objectSpread({},e.attributes),{},{isEditRender:!0})})))):c("div",a(),c(o,{block:"helsinki-linkedevents/grid",attributes:_objectSpread({},e.attributes)}));var t,n,i,r}e("helsinki-linkedevents/grid",{apiVersion:2,title:l("Helsinki - Events","helsinki-linkedevents"),category:"helsinki-linkedevents",icon:"calendar-alt",keywords:[l("events","helsinki-linkedevents"),"linked events","Helsinki - Events Grid"],supports:{html:!1,anchor:!0},attributes:{configID:{type:"string",default:0},configURL:{type:"string",default:""},eventsCount:{type:"number",default:3},title:{type:"string",default:""},contentText:{type:"string",default:""},anchor:{type:"string",default:""},blockId:{type:"string"},isEditRender:{type:"boolean",default:!1}},edit:function(l){return l.attributes.eventsCount=parseInt(l.attributes.eventsCount),l.attributes.blockId=l.clientId,n(function(){0!=l.attributes.configID&&s.apiFetch({path:"helsinki-linked-events/v1/config/"+l.attributes.configID}).then(function(e){for(var t="https://tapahtumat.hel.fi/fi/haku?",n=e,i=Object.keys(n),r=0;r<i.length;r++){var s=i[r];t+=s+"="+n[s]+"&"}l.setAttributes({configURL:t,configID:0})})},[]),c(i,{},f(l),v(l))}})}(window.wp);